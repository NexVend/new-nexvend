(function(a){a.fn.disableSelection_dropotron=function(){return a(this).css("user-select","none").css("-khtml-user-select","none").css("-moz-user-select","none").css("-o-user-select","none").css("-webkit-user-select","none")};a.fn.dropotron=function(c){if(1<this.length){for(var b=0;b<this.length;b++){a(this[b]).dropotron(c)}}return a.dropotron(a.extend({selectorParent:a(this)},c))};a.dropotron=function(c){var b=a.extend({selectorParent:null,baseZIndex:1000,menuClass:"dropotron",expandMode:"hover",hoverDelay:150,hideDelay:250,openerClass:"opener",openerActiveClass:"active",submenuClassPrefix:"level-",mode:"fade",speed:"fast",easing:"swing",alignment:"left",offsetX:0,offsetY:0,globalOffsetY:0,IEOffsetX:0,IEOffsetY:0,noOpenerFade:!0,detach:!0,cloneOnDetach:!0},c),j=b.selectorParent,k=j.find("ul"),i=a("html"),h=!1,d=null,e=null;j.on("doCollapseAll",function(){k.trigger("doCollapse")});k.each(function(){var f=a(this),g=f.parent();if(0<b.hideDelay){f.add(g).on("mouseleave",function(l){window.clearTimeout(e);e=window.setTimeout(function(){f.trigger("doCollapse")},b.hideDelay)})}f.disableSelection_dropotron().hide().addClass(b.menuClass).css("position","absolute").on("mouseenter",function(l){window.clearTimeout(e)}).on("doExpand",function(){if(f.is(":visible")){return !1}window.clearTimeout(e);k.each(function(){var l=a(this);a.contains(l.get(0),g.get(0))||l.trigger("doCollapse")});var v=g.offset(),t=g.position();g.parent().position();var r=g.outerWidth(),u=f.outerWidth(),p=f.css("z-index")==b.baseZIndex,q,o,w;if(p){q=b.detach?v:t;w=q.top+g.outerHeight()+b.globalOffsetY;o=b.alignment;f.removeClass("left").removeClass("right").removeClass("center");switch(b.alignment){case"right":v=q.left-u+r;0>v&&(v=q.left,o="left");break;case"center":v=q.left-Math.floor((u-r)/2);0>v?(v=q.left,o="left"):v+u>i.width()&&(v=q.left-u+r,o="right");break;default:v=q.left,v+u>i.width()&&(v=q.left-u+r,o="right")}f.addClass(o)}else{switch("relative"==g.css("position")||"absolute"==g.css("position")?(w=b.offsetY,v=-1*t.left):(w=t.top+b.offsetY,v=0),b.alignment){case"right":v+=-1*g.parent().outerWidth()+b.offsetX;break;default:v+=g.parent().outerWidth()+b.offsetX}}navigator.userAgent.match(/MSIE ([0-9]+)\./)&&8>RegExp.$1&&(v+=b.IEOffsetX,w+=b.IEOffsetY);f.css("left",v+"px").css("top",w+"px");f.css("opacity","0.01").show();r=!1;v="relative"==g.css("position")||"absolute"==g.css("position")?-1*t.left:0;0>f.offset().left?(v+=g.parent().outerWidth()-b.offsetX,r=!0):f.offset().left+u>i.width()&&(v+=-1*g.parent().outerWidth()-b.offsetX,r=!0);r&&f.css("left",v+"px");f.hide().css("opacity","1");switch(b.mode){case"zoom":h=!0;g.addClass(b.openerActiveClass);f.animate({width:"toggle",height:"toggle"},b.speed,b.easing,function(){h=!1});break;case"slide":h=!0;g.addClass(b.openerActiveClass);f.animate({height:"toggle"},b.speed,b.easing,function(){h=!1});break;case"fade":h=!0;p&&!b.noOpenerFade?(r="slow"==b.speed?80:"fast"==b.speed?40:Math.floor(b.speed/2),g.fadeTo(r,0.01,function(){g.addClass(b.openerActiveClass);g.fadeTo(b.speed,1);f.fadeIn(b.speed,function(){h=!1})})):(g.addClass(b.openerActiveClass),g.fadeTo(b.speed,1),f.fadeIn(b.speed,function(){h=!1}));break;default:g.addClass(b.openerActiveClass),f.show()}return !1}).on("doCollapse",function(){if(!f.is(":visible")){return !1}f.hide();g.removeClass(b.openerActiveClass);f.find("."+b.openerActiveClass).removeClass(b.openerActiveClass);f.find("ul").hide();return !1}).on("doToggle",function(l){f.is(":visible")?f.trigger("doCollapse"):f.trigger("doExpand");return !1});g.disableSelection_dropotron().addClass("opener").css("cursor","pointer").on("click",function(l){h||(l.preventDefault(),l.stopPropagation(),f.trigger("doToggle"))});"hover"==b.expandMode&&g.hover(function(l){h||(d=window.setTimeout(function(){f.trigger("doExpand")},b.hoverDelay))},function(l){window.clearTimeout(d)})});k.find("a").css("display","block").on("click",function(f){h||(j.trigger("doCollapseAll"),f.stopPropagation(),1>a(this).attr("href").length&&f.preventDefault())});j.find("li").css("white-space","nowrap").each(function(){var f=a(this),l=f.children("a"),g=f.children("ul");l.on("click",function(m){1>a(this).attr("href").length?m.preventDefault():m.stopPropagation()});if(0<l.length&&0==g.length){f.on("click",function(m){h||(j.trigger("doCollapseAll"),m.stopPropagation())})}});j.children("li").each(function(){var f=a(this).children("ul"),l;if(0<f.length){b.detach&&(b.cloneOnDetach&&(l=f.clone(),l.attr("class","").hide().appendTo(f.parent())),f.detach().appendTo("body"));l=b.baseZIndex;for(var g=1;0<f.length;g++){f.css("z-index",l++),b.submenuClassPrefix&&f.addClass(b.submenuClassPrefix+(l-1-b.baseZIndex)),f=f.find("> li > ul")}}});i.on("click",function(){h||j.trigger("doCollapseAll")}).on("keypress",function(f){h||27!=f.keyCode||(f.preventDefault(),j.trigger("doCollapseAll"))})}})(jQuery);